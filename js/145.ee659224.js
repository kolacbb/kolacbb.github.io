(self["webpackChunkAppLocalize"]=self["webpackChunkAppLocalize"]||[]).push([[145],{6241:function(e,t,a){var n,s,o;(function(a,r){s=[],n=r,o="function"===typeof n?n.apply(t,s):n,void 0===o||(e.exports=o)})(0,(function(){"use strict";function t(e,t){return"undefined"==typeof t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function n(e,t,a){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){l(n.response,t,a)},n.onerror=function(){console.error("could not download file")},n.send()}function s(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function o(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var r="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof a.g&&a.g.global===a.g?a.g:void 0,i=r.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=r.saveAs||("object"!=typeof window||window!==r?function(){}:"download"in HTMLAnchorElement.prototype&&!i?function(e,t,a){var i=r.URL||r.webkitURL,l=document.createElement("a");t=t||e.name||"download",l.download=t,l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?o(l):s(l.href)?n(e,t,a):o(l,l.target="_blank")):(l.href=i.createObjectURL(e),setTimeout((function(){i.revokeObjectURL(l.href)}),4e4),setTimeout((function(){o(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,a,r){if(a=a||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,r),a);else if(s(e))n(e,a,r);else{var i=document.createElement("a");i.href=e,i.target="_blank",setTimeout((function(){o(i)}))}}:function(e,t,a,s){if(s=s||open("","_blank"),s&&(s.document.title=s.document.body.innerText="downloading..."),"string"==typeof e)return n(e,t,a);var o="application/octet-stream"===e.type,l=/constructor/i.test(r.HTMLElement)||r.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||o&&l||i)&&"undefined"!=typeof FileReader){var d=new FileReader;d.onloadend=function(){var e=d.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=e:location=e,s=null},d.readAsDataURL(e)}else{var u=r.URL||r.webkitURL,g=u.createObjectURL(e);s?s.location=g:location.href=g,s=null,setTimeout((function(){u.revokeObjectURL(g)}),4e4)}});r.saveAs=l.saveAs=l,e.exports=l}))},8145:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return A}});var n=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"container"},[t("div",{staticClass:"App"},[t("el-card",[t("div",{staticStyle:{display:"flex","justify-content":"end","align-items":"center"}},[t("el-select",{attrs:{filterable:""},model:{value:e.languagesSelected,callback:function(t){e.languagesSelected=t},expression:"languagesSelected"}},e._l(e.languagesOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),t("el-button",{attrs:{type:"primary"},on:{click:e.downloadShell}},[e._v("Download")]),t("el-button",{attrs:{loading:e.isUploadLoading,type:"primary"},on:{click:e.uploadGooglePlay}},[e._v("Upload to Google Play")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addDialogVisible=!0}}},[e._v("Add Screenshot")])],1),e._l(e.languagesOptions,(function(a){return t("div",[t("span",{staticStyle:{margin:"12px"}},[e._v(e._s(a.label))]),t("div",{staticStyle:{"overflow-x":"auto"}},e._l(e.pageData,(function(n,s){return t("screen-canvas",{key:s,ref:"canvasRefs",refInFor:!0,staticStyle:{margin:"12px"},attrs:{"canvas-width":"1080","canvas-height":"1920",text:e.getLanguageParam(n,a.value),"background-color":n.ssBgColor,"frame-img-url":"/frames/google-pixel-4-xl-black.png","screen-url":n.ssAppUrl}})})),1)])}))],2)],1),t("el-dialog",{attrs:{title:"Add Screenshot",visible:e.addDialogVisible,width:"30%"},on:{"update:visible":function(t){e.addDialogVisible=t}}},[t("el-form",{ref:"screenshotFrom",attrs:{model:e.screenshotFrom}},[t("el-form-item",{attrs:{label:"String ID",prop:"screenshot"}},[t("el-input",{model:{value:e.screenshotFrom.transId,callback:function(t){e.$set(e.screenshotFrom,"transId",t)},expression:"screenshotFrom.transId"}})],1),t("el-form-item",{attrs:{label:"Screenshot Url",prop:"screenshot"}},[t("el-input",{model:{value:e.screenshotFrom.ssAppUrl,callback:function(t){e.$set(e.screenshotFrom,"ssAppUrl",t)},expression:"screenshotFrom.ssAppUrl"}})],1),t("el-form-item",{attrs:{label:"Background Color(eg: #0000000)",prop:"screenshot"}},[t("el-input",{model:{value:e.screenshotFrom.ssBgColor,callback:function(t){e.$set(e.screenshotFrom,"ssBgColor",t)},expression:"screenshotFrom.ssBgColor"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.addDialogVisible=!1}}},[e._v("Cancel")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handAddScreenshot}},[e._v("Add")])],1)],1)],1)},s=[],o=(a(7658),a(6693)),r=function(){var e=this,t=e._self._c;return t("canvas",{ref:"screenCanvas"},[e._v("Canvas not supported "+e._s(e.refreshCanvas(e.text)))])},i=[],l=(a(2801),a(1439),a(7585),a(5315),{props:["canvasWidth","canvasHeight","text","backgroundColor","frameImgUrl","screenUrl"],data(){return{}},methods:{refreshCanvas(e){const t=this.canvasWidth,a=this.canvasHeight,n=this.$refs.screenCanvas;if(null==n)return;if(n.setAttribute("width",t+""),n.setAttribute("height",a+""),n.style.width=this.canvasWidth/4.5+"px",n.style.height=this.canvasHeight/4.5+"px",!n.getContext)return;const s=n.getContext("2d");s.fillStyle=this.backgroundColor,s.fillRect(0,0,t,a);const o={path:this.frameImgUrl,x:.05*t,y:.18*a,width:1564,height:3320,startX:59.4,startY:191.2,endX:1501.4,endY:3232.9,extraY:1548.8},r=.9*t/o.width;o.width=o.width*r,o.height=o.height*r,o.startX=o.x+o.startX*r,o.startY=o.y+o.startY*r,o.endX=o.x+o.endX*r,o.endY=o.y+o.endY*r;const i=this.text.split("\\n");s.beginPath(),s.fillStyle="#FFFFFF",s.textAlign="center";let l=64;for(let d=0;d<i.length&&d<2;d++)s.font="bolder 74px Arial",s.fillText(i[d],t/2,100*(d+1)+l,t-o.x);s.closePath();var c=new Image;c.crossOrigin="Anonymous",c.src=this.screenUrl,c.onload=function(){const e=Math.max((o.endX-o.startX)/this.width,(o.endY-o.endX)/this.height);s.drawImage(this,o.startX,o.startY,this.width*e,this.height*e);let t=new Image;t.src=o.path,t.onload=function(){s.drawImage(this,o.x,o.y,o.width,o.height)}}},exportImages(){const e=this.$refs.screenCanvas;var t=e.toDataURL("image/png"),a=this.dataURLtoBlob(t);let n=new File([a],(new Date).getTime()+".jpg");return n},dataURLtoBlob(e){var t=e.split(","),a=t[1].substring(0,t[1].length-2),n=t[0].match(/:(.*?);/)[1],s=atob(a),o=s.length,r=new Uint8Array(o);while(o--)r[o]=s.charCodeAt(o);return new Blob([r],{type:n})}},mounted(){this.refreshCanvas()}}),c=l,d=a(3736),u=(0,d.Z)(c,r,i,!1,null,null,null),g=u.exports,p=a(3329);const h=e=>p.Z.post("/screenshots/get",e),f=e=>p.Z.post("/screenshots/insert",e),m=e=>{let t={headers:{"Content-Type":"multipart/form-data"}};return p.Z.postForm("/screenshots/upload",e,t)};var v=a(6241),b=a.n(v),y={components:{ScreenCanvas:g},data(){return{isLoading:!1,addDialogVisible:!1,isUploadLoading:!1,languagesOptions:[],languagesSelected:"EN",pageData:[],screenshotFrom:{projectId:this.$route.params.id,transId:0,ssAppUrl:"",ssBgColor:""}}},computed:{},watch:{projectData(e,t){this.$route.params.id==this.$store.state.tab.projectData.projectId&&this.refreshPage()},languagesSelected(e,t){e!=t&&(this.pageData=this.pageData)}},mounted(){this.refreshPage()},methods:{refreshPage(){const e=this.$store.state.tab.projectData;if(this.$route.params.id!=e.projectId)return;const t=[];e.languages.split(",").forEach((e=>{t.push(e.trim())})),this.languagesOptions=[],Object.keys(o.Z.state.allLanguages).forEach((e=>{t.includes(o.Z.state.languageKey[e])&&this.languagesOptions.push({label:o.Z.state.allLanguages[e],value:o.Z.state.languageKey[e]})}));const a={projectId:this.$route.params.id};h(a).then((e=>{this.isLoading=!1,console.log(e),this.pageData=e.data}))},getLanguageParam(e,t){let a="";return console.log(t),Object.keys(o.Z.state.languageKey).forEach((n=>{t===o.Z.state.languageKey[n]&&(a=e.transKeys[n])})),a},getLanguageName(){return o.Z.state.languages[this.languagesSelected]},handAddScreenshot(){f(this.screenshotFrom).then((e=>{console.log(e),this.addDialogVisible=!1}))},uploadGooglePlay(){this.isUploadLoading=!0;let e=new Array(this.$refs.canvasRefs.length);for(let a=0;a<this.$refs.canvasRefs.length;a++)e[a]=this.$refs.canvasRefs[a].exportImages();let t=new FormData;Array.from(e).forEach((e=>{t.append("files",e)})),t.append("projectId",this.$route.params.id),t.append("languages",this.languagesSelected),m(t).then((e=>{this.isUploadLoading=!1,console.log(e)}))},formatImageUrl(e){return this.require("/assets/logo.png")},downloadShell(){var e="#!/bin/bash\n";e+="adb devices";const t=new Blob([e],{type:"text/plain;charset=utf-8"});b().saveAs(t,"applocalize_gen_screenshot.bat")}}},w=y,x=(0,d.Z)(w,n,s,!1,null,"d0e03824",null),A=x.exports}}]);
//# sourceMappingURL=145.ee659224.js.map