"use strict";(self["webpackChunkAppLocalize"]=self["webpackChunkAppLocalize"]||[]).push([[503],{5503:function(e,t,a){a.r(t),a.d(t,{default:function(){return x}});var s=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"container"},[t("div",{staticClass:"App"},[t("el-card",[t("div",{staticStyle:{display:"flex","justify-content":"end","align-items":"center"}},[t("el-select",{attrs:{filterable:""},model:{value:e.languagesSelected,callback:function(t){e.languagesSelected=t},expression:"languagesSelected"}},e._l(e.languagesOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),t("el-button",{attrs:{loading:e.isUploadLoading,type:"primary"},on:{click:e.uploadGooglePlay}},[e._v("Upload to Google Play")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addDialogVisible=!0}}},[e._v("Add Screenshot")])],1),e._l(e.languagesOptions,(function(a){return t("div",[t("span",{staticStyle:{margin:"12px"}},[e._v(e._s(a.label))]),t("div",{staticStyle:{"overflow-x":"auto"}},e._l(e.pageData,(function(s,n){return t("screen-canvas",{key:n,ref:"canvasRefs",refInFor:!0,staticStyle:{margin:"12px"},attrs:{"canvas-width":"1080","canvas-height":"1920",text:e.getLanguageParam(s,a.value),"background-color":s.ssBgColor,"frame-img-url":"/frames/google-pixel-4-xl-black.png","screen-url":s.ssAppUrl}})})),1)])}))],2)],1),t("el-dialog",{attrs:{title:"Add Screenshot",visible:e.addDialogVisible,width:"30%"},on:{"update:visible":function(t){e.addDialogVisible=t}}},[t("el-form",{ref:"screenshotFrom",attrs:{model:e.screenshotFrom}},[t("el-form-item",{attrs:{label:"String ID",prop:"screenshot"}},[t("el-input",{model:{value:e.screenshotFrom.transId,callback:function(t){e.$set(e.screenshotFrom,"transId",t)},expression:"screenshotFrom.transId"}})],1),t("el-form-item",{attrs:{label:"Screenshot Url",prop:"screenshot"}},[t("el-input",{model:{value:e.screenshotFrom.ssAppUrl,callback:function(t){e.$set(e.screenshotFrom,"ssAppUrl",t)},expression:"screenshotFrom.ssAppUrl"}})],1),t("el-form-item",{attrs:{label:"Background Color(eg: #0000000)",prop:"screenshot"}},[t("el-input",{model:{value:e.screenshotFrom.ssBgColor,callback:function(t){e.$set(e.screenshotFrom,"ssBgColor",t)},expression:"screenshotFrom.ssBgColor"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.addDialogVisible=!1}}},[e._v("Cancel")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handAddScreenshot}},[e._v("Add")])],1)],1)],1)},n=[],r=(a(7658),a(6693)),o=function(){var e=this,t=e._self._c;return t("canvas",{ref:"screenCanvas"},[e._v("Canvas not supported "+e._s(e.refreshCanvas(e.text)))])},l=[],i=(a(2801),a(1439),a(7585),a(5315),{props:["canvasWidth","canvasHeight","text","backgroundColor","frameImgUrl","screenUrl"],data(){return{}},methods:{refreshCanvas(e){const t=this.canvasWidth,a=this.canvasHeight,s=this.$refs.screenCanvas;if(null==s)return;if(s.setAttribute("width",t+""),s.setAttribute("height",a+""),s.style.width=this.canvasWidth/4.5+"px",s.style.height=this.canvasHeight/4.5+"px",!s.getContext)return;const n=s.getContext("2d");n.fillStyle=this.backgroundColor,n.fillRect(0,0,t,a);const r={path:this.frameImgUrl,x:.05*t,y:.18*a,width:1564,height:3320,startX:59.4,startY:191.2,endX:1501.4,endY:3232.9,extraY:1548.8},o=.9*t/r.width;r.width=r.width*o,r.height=r.height*o,r.startX=r.x+r.startX*o,r.startY=r.y+r.startY*o,r.endX=r.x+r.endX*o,r.endY=r.y+r.endY*o;const l=this.text.split("\\n");n.beginPath(),n.fillStyle="#FFFFFF",n.textAlign="center";let i=64;for(let g=0;g<l.length&&g<2;g++)n.font="bolder 74px Arial",n.fillText(l[g],t/2,100*(g+1)+i,t-r.x);n.closePath();var c=new Image;c.crossOrigin="Anonymous",c.src=this.screenUrl,c.onload=function(){const e=Math.max((r.endX-r.startX)/this.width,(r.endY-r.endX)/this.height);n.drawImage(this,r.startX,r.startY,this.width*e,this.height*e);let t=new Image;t.src=r.path,t.onload=function(){n.drawImage(this,r.x,r.y,r.width,r.height)}}},exportImages(){const e=this.$refs.screenCanvas;var t=e.toDataURL("image/png"),a=this.dataURLtoBlob(t);let s=new File([a],(new Date).getTime()+".jpg");return s},dataURLtoBlob(e){var t=e.split(","),a=t[1].substring(0,t[1].length-2),s=t[0].match(/:(.*?);/)[1],n=atob(a),r=n.length,o=new Uint8Array(r);while(r--)o[r]=n.charCodeAt(r);return new Blob([o],{type:s})}},mounted(){this.refreshCanvas()}}),c=i,g=a(3736),h=(0,g.Z)(c,o,l,!1,null,null,null),d=h.exports,u=a(3329);const p=e=>u.Z.post("/screenshots/get",e),f=e=>u.Z.post("/screenshots/insert",e),m=e=>{let t={headers:{"Content-Type":"multipart/form-data"}};return u.Z.postForm("/screenshots/upload",e,t)};var v={components:{ScreenCanvas:d},data(){return{isLoading:!1,addDialogVisible:!1,isUploadLoading:!1,languagesOptions:[],languagesSelected:"EN",pageData:[],screenshotFrom:{projectId:this.$route.params.id,transId:0,ssAppUrl:"",ssBgColor:""}}},computed:{},watch:{projectData(e,t){this.$route.params.id==this.$store.state.tab.projectData.projectId&&this.refreshPage()},languagesSelected(e,t){e!=t&&(this.pageData=this.pageData)}},mounted(){this.refreshPage()},methods:{refreshPage(){const e=this.$store.state.tab.projectData;if(this.$route.params.id!=e.projectId)return;const t=[];e.languages.split(",").forEach((e=>{t.push(e.trim())})),this.languagesOptions=[],Object.keys(r.Z.state.allLanguages).forEach((e=>{t.includes(r.Z.state.languageKey[e])&&this.languagesOptions.push({label:r.Z.state.allLanguages[e],value:r.Z.state.languageKey[e]})}));const a={projectId:this.$route.params.id};p(a).then((e=>{this.isLoading=!1,console.log(e),this.pageData=e.data}))},getLanguageParam(e,t){let a="";return console.log(t),Object.keys(r.Z.state.languageKey).forEach((s=>{t===r.Z.state.languageKey[s]&&(a=e.transKeys[s])})),a},getLanguageName(){return r.Z.state.languages[this.languagesSelected]},handAddScreenshot(){f(this.screenshotFrom).then((e=>{console.log(e),this.addDialogVisible=!1}))},uploadGooglePlay(){this.isUploadLoading=!0;let e=new Array(this.$refs.canvasRefs.length);for(let a=0;a<this.$refs.canvasRefs.length;a++)e[a]=this.$refs.canvasRefs[a].exportImages();let t=new FormData;Array.from(e).forEach((e=>{t.append("files",e)})),t.append("projectId",this.$route.params.id),t.append("languages",this.languagesSelected),m(t).then((e=>{this.isUploadLoading=!1,console.log(e)}))},formatImageUrl(e){return this.require("/assets/logo.png")}}},b=v,y=(0,g.Z)(b,s,n,!1,null,"154a145e",null),x=y.exports}}]);
//# sourceMappingURL=503.13091903.js.map